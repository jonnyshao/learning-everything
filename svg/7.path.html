<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <style>
  *{
      margin: 0;
      padding: 0;
    }
    div{
      width: 780px;
      height: 400px;
      border: 1px solid red;
      margin: 0 auto;
      overflow: hidden;
    }
    </style>
  <div id="container">
      <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" id="svg">
       <!-- <path d="M50,100,L200,200,100,100,ZM300,100,L300,300" stroke="black" stroke-width="2" fill="none"></path> -->
       <!-- 如果是小写的h v 是实际的长度 -->
       <!-- <path d="M50 100H200V200" stroke="black" stroke-width="2" fill="none"></path> -->
       <!-- 0 -->
       <!-- <path d="M100 100A100 100 0 0 0 200 200" stroke="black" stroke-width="2" fill="none"></path> -->
       <!-- <path d="M150 150A100 100 0 0 1 250 150L225 175A50 50 0 0 0 175 175Z" stroke="black" stroke-width="2" fill="none"></path> -->
      </svg>
  </div>
  <script src="https://cdn.bootcss.com/jquery/3.4.0/jquery.js"></script>
  <script>
    var ns = 'http://www.w3.org/2000/svg'
    var con = document.getElementById('container')
    var svg = document.getElementById('svg')
    var aPath = svg.getElementsByTagName('path')
    // var arrNum = [15,30,40,15];
    var arrNum = [23.61,17.10,16.05,15.40,11.72,14.95];
    var angle = 360;
    var outerR = 120;
    var innerR = 70;
    var centerX = 200;
    var centerY = 200;
    
    var colors = ['red','blue','orange','yellow','deeppink','gray','green','black']

    // for (var i = 0; i < arrNum.length; i++) {
    //   var path = createTag('path',{fill: colors[i]})
    //   svg.appendChild(path);
    // }
    $('#container').animate({move: 'auto'},{
      duration: 1000,
      easing: 'swing',
      step: function (a, b) {
        var outerXY =[{x: 320, y:200}];
        var innerXY =[{x:270, y: 200}];
        var sum = 0;
        //b.pos 0-1不断运动的一个值
        arrNum.forEach((item, i) => {
          var itemAangle = item / 100 * angle
          // 拿到每次生成的总角度
          sum += itemAangle
          if (i === arrNum.length -1) {
            sum = 360
          }
          var outerX = Math.cos(sum * b.pos * Math.PI/180) * outerR + centerX
          var outerY = Math.sin(sum * b.pos *  Math.PI/180) * outerR + centerY
          outerXY.push({x: outerX, y: outerY})
          var innerX = Math.cos(sum * b.pos * Math.PI/180) * innerR + centerX
          var innerY = Math.sin(sum * b.pos * Math.PI/180) * innerR + centerY
          innerXY.push({x: innerX, y: innerY})
        })

        for (var i = 0; i < outerXY.length; i++) {
          if (i === outerXY.length - 1) {
            break;
          }
          var path = createTag('path',{fill: colors[i], d: `M${outerXY[i].x},${outerXY[i].y},A${outerR},${outerR},0,0,1,${outerXY[i+1].x},${outerXY[i+1].y},L${innerXY[i+1].x},${innerXY[i+1].y},A${innerR},${innerR},0,0,0,${innerXY[i].x},${innerXY[i].y}`})
          svg.appendChild(path)
        }
      }
    })
    // for (var i = 0; i < outerXY.length; i++) {
    //   if (i === outerXY.length - 1) {
    //     break;
    //   }
    //   var path = createTag('path',{fill: colors[i], d: `M${outerXY[i].x},${outerXY[i].y},A${outerR},${outerR},0,0,1,${outerXY[i+1].x},${outerXY[i+1].y},L${innerXY[i+1].x},${innerXY[i+1].y},A${innerR},${innerR},0,0,0,${innerXY[i].x},${innerXY[i].y}`})
    //   svg.appendChild(path)
    // }
    
    function createTag(tag, attrs) {
      var curTag = document.createElementNS(ns, tag)
      for (var attr in attrs) {
        curTag.setAttribute(attr, attrs[attr])
      }
      return curTag
    }
 
  </script>
</body>
</html>